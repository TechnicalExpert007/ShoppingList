import{a as g,c as v,d as y,wa as x}from"./chunk-DU7L5G2L.js";import{i as f}from"./chunk-OYAVQN5W.js";var p,L=new Uint8Array(16);function h(){if(!p&&(p=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!p))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return p(L)}var w=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function R(t){return typeof t=="string"&&w.test(t)}var _=R;var a=[];for(m=0;m<256;++m)a.push((m+256).toString(16).substr(1));var m;function j(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=(a[t[s+0]]+a[t[s+1]]+a[t[s+2]]+a[t[s+3]]+"-"+a[t[s+4]]+a[t[s+5]]+"-"+a[t[s+6]]+a[t[s+7]]+"-"+a[t[s+8]]+a[t[s+9]]+"-"+a[t[s+10]]+a[t[s+11]]+a[t[s+12]]+a[t[s+13]]+a[t[s+14]]+a[t[s+15]]).toLowerCase();if(!_(l))throw TypeError("Stringified UUID is invalid");return l}var b=j;function A(t,s,l){t=t||{};var e=t.random||(t.rng||h)();if(e[6]=e[6]&15|64,e[8]=e[8]&63|128,s){l=l||0;for(var i=0;i<16;++i)s[l+i]=e[i];return s}return b(e)}var c=A;var X=(()=>{let s=class s{constructor(e){this.storage=e,this._storage=null,this._lists=new g([]),this.init()}init(){return f(this,null,function*(){let e=yield this.storage.create();this._storage=e,this.loadLists()})}loadLists(){return f(this,null,function*(){var i;let e=(yield(i=this._storage)==null?void 0:i.get("shopping-lists"))||[];this._lists.next(e)})}getLists(){return this._lists.asObservable()}addList(e,i){return f(this,null,function*(){var r;let o=this._lists.value,n={id:c(),name:e,priority:i,items:[],createdAt:new Date,updatedAt:new Date};o.push(n),yield(r=this._storage)==null?void 0:r.set("shopping-lists",o),this._lists.next(o)})}addItem(e,i){return f(this,null,function*(){var r;let o=this._lists.value,n=o.find(d=>d.id===e);if(n){let d={id:c(),name:i.name||"",quantity:i.quantity||1,notes:i.notes,isChecked:!1};n.items.push(d),n.updatedAt=new Date,yield(r=this._storage)==null?void 0:r.set("shopping-lists",o),this._lists.next(o)}})}updateItem(e,i,o){return f(this,null,function*(){var d;let n=this._lists.value,r=n.find(u=>u.id===e);if(r){let u=r.items.find(I=>I.id===i);u&&(Object.assign(u,o),r.updatedAt=new Date,yield(d=this._storage)==null?void 0:d.set("shopping-lists",n),this._lists.next(n))}})}removeItem(e,i){return f(this,null,function*(){var r;let o=this._lists.value,n=o.find(d=>d.id===e);n&&(n.items=n.items.filter(d=>d.id!==i),n.updatedAt=new Date,yield(r=this._storage)==null?void 0:r.set("shopping-lists",o),this._lists.next(o))})}deleteList(e){return f(this,null,function*(){var o;let i=this._lists.value.filter(n=>n.id!==e);yield(o=this._storage)==null?void 0:o.set("shopping-lists",i),this._lists.next(i)})}};s.\u0275fac=function(i){return new(i||s)(y(x))},s.\u0275prov=v({token:s,factory:s.\u0275fac,providedIn:"root"});let t=s;return t})();export{X as a};
